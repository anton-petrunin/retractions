\documentclass[oneside,a4paper, 12pt]{article}
\usepackage{anysize}
\usepackage{retraction}
\usepackage{biber}

\hypersetup{pdftitle={Short retractions of CAT(1) spaces},
pdfauthor={Alexander Lytchak and Anton Petrunin}}

\begin{document}
\title{Short retractions of CAT(1) spaces}
\author{Alexander Lytchak and Anton Petrunin}
\date{}
\maketitle

\begin{abstract}
We construct short retractions of a CAT(1) space to its small convex subsets.
This construction provides an alternative geometric description of an analytic tool introduced by Wilfrid Kendall. 
\end{abstract}


\section{Introduction}

\parbf{Results.}
Recall that a  subset $K$ in a metric space ${\spc{U}}$ is called \emph{weakly convex} if any two points $x,y\in K$ can be connected by a minimizing geodesic in $K$.

Let ${\spc{U}}$ be a metric space and $K\subset {\spc{U}}$.
A distance nonexpanding map $f\:{\spc{U}}\to K$ such that $f(x)=x$ for any $x\in K$ is called a \emph{short retraction to $K$}.
If in addition a local Lipschitz constant of $f$ is strictly less than 1 at any point $p\notin K$, 
then we say that $f$ is a \emph{strictly short retraction from ${\spc{U}}$ to $K$}.

\begin{thm}{Proposition}\label{thm:retraction:Phi}
Let $\spc{U}$ be a complete length $\CAT(\kappa)$ space.
Suppose $K$ is a weakly convex closed subset in $\spc{U}$ and $|p-x|\le \tfrac\pi2$ for for a fixed point $p\in \spc{U}$ and any point $x\in K$.


\begin{enumerate}[(a)]
 \item If $p\in K$ and $\kappa\le 1$, then there is a short retraction 
$\Phi\:\spc{U}\to K$.
\item If $\kappa<1$, then there is a strictly short retraction 
$\Phi\:\spc{U}\to K$.
\end{enumerate}
\end{thm}

This statement is a generalization of the following well known statement about $\CAT(0)$ spaces:
\emph{If ${\spc{U}}$ is a complete length $\CAT(0)$ space and $K$ is a closed convex subset in ${\spc{U}}$,
then the closest point projection ${\spc{U}}\to K$ is a short retraction.
Moreover, if $\spc{U}$ is a $\CAT(\kappa)$ space for some $\kappa<0$, then  the closest point projection is a strictly short retraction}.

\begin{thm}{Corollary}\label{cor}
Let $\spc{U}$ be a complete length $\CAT(\kappa)$ space.
Denote by $\Delta$ the diagonal in $\spc{U}\times \spc{U}$;
that is, $\Delta=\{\,(x,x)\in \spc{U}\times \spc{U}\,\}$.

Suppose there is a point $p\in \spc{U}$ such that $|p-x|\le \tfrac\pi2$ for any point $x\in \spc{U}$.
\begin{enumerate}[(a)]
\item
If $\kappa\le 1$, then there is a short retraction $\Psi\:\spc{U}\times \spc{U}\to \Delta$.
\item If $\kappa<1$, then there is a strictly short retraction $\Psi\:\spc{U}\times \spc{U}\to \Delta$.
\end{enumerate}

\end{thm}

It is well known that if $\spc{U}$ be a complete length $\CAT(0)$ space, then the midpoint map $\spc{U}\times \spc{U}\to \spc{U}$ is $\tfrac1{\sqrt{2}}$-Lipschitz and therefore it induces a short retraction of the product space $\spc{U}\times \spc{U}\to\Delta$. 
The corollary provides an analogous statement for $\CAT(1)$ spaces.


\parbf{Motivation.}
In \cite[(4.1)]{kendall}, Wilfrid Kendall observed that if $\spc{B}$ is a regular geodesic ball or radius $r<\tfrac\pi2$ in a manifold with sectional curvature at most 1, then for appropriate choice of constant $\lambda$, the following function
\[(x,y)\mapsto 
\frac{1+\lambda-\cos|x-y|_{\spc{B}}}{\cos|p-x|_{\spc{B}}\cdot \cos|p-y|_{\spc{B}}}
\]
has convex level sets in ${\spc{B}}\times {\spc{B}}$.
He also shows the existence of a nonnegative convex function on ${\spc{B}}\times {\spc{B}}$ that vanish only on the diagonal \cite[(4.2)]{kendall}.
These observations became a useful tool to study Dirichlet problem and its relatives;
it makes possible to extend number of results from Hadamard manifolds to Riemannian manifolds of small size
and more generally to $\CAT(1)$ spaces~\cite{yokota,BFHMSZ,fuglede,serbinowski}. 

Our original goal was to make this tool transparent for geometers.
Corollary~\ref{cor} can be considered as a more geometric version of this tool.
While Kendall's condition is optimal for uniqueness and regularity questions, the existence statements can be derived from  Proposition~\ref{thm:retraction:Phi} in a
slightly greater generality, as  we are going to explain now.

Recall that a metric space ${\spc{U}}$ is called \emph{$1$-complemented} if for some \emph{non-principal ultrafilter} $\omega$  there exists a short retraction of ultracompletion ${\spc{U}}^{\omega}$ to~${\spc{U}}$.
This definition was introduced by Stefan Wenger \cite{Wenger-1comp};
for the definitions of ultrafilters and ultracompletions we refer to \cite{Wenger-1comp,guo-wenger,akp}. 

Recall that any metric space ${\spc{U}}$ forms a subset in its ultracompletion ${\spc{U}}^{\omega}$, or more precisely, ${\spc{U}}$ admits a canonical isometric embedding into ${\spc{U}}^{\omega}$.
Moreover if ${\spc{U}}$ is $\CAT(\kappa)$ then so is~${\spc{U}}^\omega$. 
Applying these two observations together with Proposition~\ref{thm:retraction:Phi}, we obtain

\begin{thm}{Theorem}\label{thm:complemented}
Let ${\spc{U}}$ be  a $\CAT(1)$ space.
Assume  there exists some $p\in {\spc{U}}$ such that $|p-x|\le \tfrac\pi2$ for any point $x\in {\spc{U}}$.
Then ${\spc{U}}$ is $1$-complemented.
\end{thm}

Let us list few existence results which follow from the theorem, assuming that the space ${\spc{U}}$ as above:
\begin{enumerate}[(a)]
\item\label{dirichlet}   The existence of solution $u$ of Dirichlet problem on the minimization of energy 
in $W^{1,2} (\Omega, {\spc{U}})$ on any Lipschitz domain $\Omega$ in a Riemannian manifold with prescirbed trace $tr(u)$.
(See \cite{KS} and \cite[Theorem 1.4]{guo-wenger}).
\item The existence of a minimal integral $k$-current filling of any prescribed boundaryless $(k-1)$ integral current in ${\spc{U}}$. 
(See \cite{Ambrosio} and \cite[Theorem 3.3]{Wenger-1comp}.)
\item   The existence of a conformally parametrized disc $u:D\to {\spc{U}}$ of minimal area for a given boundary curve $\gamma$, which is a Jordan curve of finite length in ${\spc{U}}$.
(See \cite{LWplateau} and \cite[Theorem 1.2]{guo-wenger}).
\item\label{center} For any Radon measure $\mu$ on ${\spc{U}}$ there exists a center of mass $x\in {\spc{U}}$ for the measure~$\mu$ \cite{Sturm, yokota}.
\end{enumerate}

If in the theorem, we assume strict inequality $|p-x|< \tfrac\pi2$, then the existence results are known  in all the cases (\ref{dirichlet}--\ref{center}).
Moreover the uniqueness hold true under this stronger assumption
\cite{yokota,serbinowski}.
In our boundary case uniqueness definitely fails, since geodesics between points in a round hemisphere are not unique.

The uniqueness in each case can be shown using Corollary \ref{cor}.
Indeed if there are different solutions of one of these problems, then their product in ${\spc{U}}\times {\spc{U}}$ does not lie in the diagonal.
The latter contradicts the existence of the strictly short retraction $\Psi$ provided by Corollary \ref{cor}.

\parbf{About the proofs.}
We use a new tool which we call \emph{tractrix flow}; it gives a family of maps $\phi_t$ for a given rectifiable curve $t\mapsto\gamma(t)$.
The important properties of the tractrix flow are collected in Proposition~\ref{prop-def}.
In particular, if $\spc{U}$ is $\CAT(1)$ and $r\le \tfrac\pi2$, then $\phi_t$ is short for any $t$ 
and if $r< \tfrac\pi2$ then the local Lipschitz constant of $\phi_t$ at $p$ is strictly less than 1 if $p\ne \phi_t(p)$.

In the proof of Proposition~\ref{thm:retraction:Phi}, the tractrix flow is applied in a space arising by gluing $\spc{U}$ with a spherical cone over $K$ along $K$;
this space is $\CAT(1)$ by Reshetnyak's gluing theorem.

In the proof of Corollary~\ref{cor} the additional trick consists in identifying the product $\spc{U}\times \spc{U}$ in a canonical way with a subset of the spherical join $\spc{U}\star \spc{U}$ and applying  Proposition~\ref{thm:retraction:Phi} to the latter.

The tricks in both proofs show that it is useful to consider singular spaces even in the case when the original space ($\spc{U}$) is perfectly smooth;
this is an important freedom of the Alexandrov's worlds.
More involved examples of such arguments are given by Dmitry Burago, Sergei Ferleger, and Alexey Kanonenko \cite{BFK}, and Stephan Stadler~\cite{stadler}.

\section{Tractrix flow}\label{sec:Tractrix flow}

For $\CAT(\kappa)$ spaces, we will follow the conventions in \cite{akp}.

First let us describe the tractrix flow informally.
Suppose that two points $p$ and $q$ in ${\spc{U}}$ are connected to each other by a thread of fixed length $r<\pi$.
Imagine that the point $q$ follow the curve $\gamma$ and drags $p$ if the thread is tight; 
if the is not tight, then $p$ does not move.
Then the trajectory of the point $p$ will be called $r$-\emph{tractrix} of $p$ with respect to the curve
and the family of maps $\phi_t$ that send initial position of $p$ to its position at the time $t$ will be called $r$-\emph{tractrix flow}.

Speaking more formally, let $\gamma\:[a,b]\to \spc{U}$ be a 1-Lipschitz curve. 
An $r$-tractrix with respect to $\gamma$ is defined as a gradient curve for the time-dependent family of functions 
\[f_t=- \max\{r,\dist_{\gamma(t)}\}\]
if the initial point lies in $\bar B[\gamma(a),r]$
(here $\bar B[x,r]$ denotes the closed ball of radius $r$ centered at $x$).

The map $\phi_t\:\bar B[\gamma(a),r]\to\bar B[\gamma(t),r] $ defined as $\phi_t\:\tau(a)\mapsto \tau(t)$ 
for an $r$-tractrix $\tau$
is called the $r$-\emph{tractrix flow} with respect to $\gamma$.

The following proposition includes the properties of the tractrix flow which will be used further in the paper.

\begin{thm}{Proposition}\label{prop-def}
Let $\spc{U}$ be a complete length $\CAT(\kappa)$ space for $\kappa\le 1$ and $r<\pi$.
Then the $r$-tractrix flow $\phi_t\:\bar B[\gamma(a),r]\to\bar B[\gamma(t),r]$ is uniquely defined for any  1-Lipschitz curve $\gamma\:[a,b]\to \spc{U}$.
Moreover, if $r=\tfrac\pi2$, then
\begin{enumerate}[(a)]
 \item $\phi_t$ is short for any $t$;
 \item if $\kappa<1$, then there is a positive constant $\eps$ such that the local Lipschitz constant of $\phi_t$ at $p$ is bounded above by $\exp(-\eps\cdot\ell)$, where $\ell=|p-\phi_t(p)|_{\spc{U}}$.
 \item\label{sharafutdinov} If the family of balls $B_t=\bar B[\gamma(t),r]$ is decreasing in $t$ (that is, if $B_{t_1}\supset B_{t_2}$ for $t_1<t_2$), then $\phi_t$ is a strong deformation retraction from $B_a$ to $B_b$.
\end{enumerate}
\end{thm}

Historically the first relative of tractrix flow
is the so called \emph{Sharafutdinov's retraction} \cite{sharafutdinov} --- a family of maps associated to a continuous family of convex sets (in our case these sets are the balls $B_t$). 
Second relative is the \emph{pursuer flow} introduced and studied by Stephanie Alexander, Richard Bishop, Robert Ghrist and Chanyoung Jun \cite{ABG,jun-thesis,jun,jun:grad}.
The proofs from any of these papers can be easily adapted to prove our proposition.

Let us also mention that time-dependent gradient flows were studied in \cite{jun-thesis,jun:grad} but only in the $\CAT(0)$ case, despite that $\CAT(\kappa)$ case is equally simple.
In a bloodcurdling generality, time-dependent gradient flows were studied by Lucas C. F. Ferreira1 and Julio C. Valencia-Guevara1 \cite{ferreira-valencia}.
Gradient flows for time-independent function in $\CAT(\kappa)$ spaces were studied in \cite{lytchak-open-map} and \cite{ohta-palfia} and it is not hard to generalize their results to the time dependent flow.

Since we can not find a precise reference to the statement, we give a sketch of a very direct proof of the proposition;
a reader experienced with $\CAT(\kappa)$ comparison should be able to fill the details.

\parit{Stretch of proof.}
First let us define a \emph{discrete} tractrix.
Fix positive numbers $r<\pi$ and $\eps<\pi-r$. 
A sequence of points $q_0,\dots,q_n$ in  ${\spc{U}}$ will be called an $\eps$-chain if $|q_i-q_{i-1}|_{\spc{U}}<\eps$ for each $i$.
Suppose $p=p_0$ is a point that lies on distance at most $r$ from  $q_0$.
Consider another sequence $p_0,\dots p_n$ defined recursively the following way:
\emph{$p_i$ is the closest point to $p_{i-1}$ that lies on the distance at most $r$ from $q_i$}.
This sequence (if defined) will be called \emph{discrete tractrix} of $p$ with respect to the $\eps$-chain $(q_i)$.

Note that if ${\spc{U}}$ is a geodesic space, then 
$p_i$ lies on a geodesic from $p_{i-1}$ to $q_i$; 
in this case the sequence $(p_i)$ is defined.
Moreover the triangle inequality implies that $(p_i)$ is an $\eps$-chain.

Note also that $|p_{i-1}-p_i|_{\spc{U}}<\pi$ for each $i$.
Therefore, if ${\spc{U}}$ is $\CAT(1)$, then the geodesic $[p_{i-1},q_i]$ is uniquely defined and 
so is the discrete tractrix $(p_i)$.

Now assume that $\gamma\:[a,b]\to \spc{U}$ is a Lipschitz curve.
Fix a fine partition $a=t_0<\dots<t_n=b$ and set $q_i=\gamma(t_i)$.
Since the partition is fine, we can assume that $(q_i)$ is an $\eps$-chain for any $\eps>0$ fixed in advance.
Moreover, we may assume that each arc $\gamma|_{[t_{i-1},t_i]}$ has diameter at most $\eps$ for each $i$.
Applying $\CAT(1)$ comparison it is straightforward to prove that for finer and finer partition the $p$-chain converges to a curve $\tau\:[a,b]\to \spc{U}$ that will be called $r$-tractrix of $p$ with respect to $\gamma$.

The needed distance estimates also follow from the corresponding estimates in the discrete case.
\qeds


\section{Proofs}\label{sec:proofs}

Recall that spherical join $\spc{U}\star\spc{V}$ of two metric spaces $\spc{U}$ and $\spc{V}$
is defined as the unit sphere equipped with the angle metric in the product of Euclidean cones $\Cone \spc{U}\times \Cone\spc{V}$. 
If diameters of $\spc{U}$ and $\spc{V}$ do not exceed $\pi$, then $\spc{U}\star\spc{V}$
can be defined as a metric space that admits an onto map $\iota\:\spc{U}\times\spc{V}\times[0,\tfrac\pi2]\to \spc{U}\star\spc{V}$ such that
\[
\begin{aligned}
|\iota(u_1,v_1,t_1)&-\iota(u_2,v_2,t_2)|_{\spc{U}\star\spc{V}}=
\\
&=\arccos[\sin t_1\cdot\sin t_2\cdot \cos|u_1-u_2|_{\spc{U}}+\cos t_1\cdot \cos t_2\cdot \cos|v_1-v_2|_{\spc{V}}].
\end{aligned}
\eqlbl{join-formula}
\]

Note that join of two $\CAT(1)$ spaces is $\CAT(1)$.
Indeed, $\spc{U}$ and $\spc{V}$ are $\CAT(1)$ if and only if their Euclidean cones $\Cone \spc{U}$ and $\Cone\spc{V}$ are $\CAT(0)$ \cite[10.4.2]{akp}.
Therefore, the product-cone $\Cone \spc{U}\times\Cone\spc{V}$ is also $\CAT(0)$ and the unit sphere $\spc{U}\star\spc{V}$ in this cone is $\CAT(1)$.

\parit{Proof of \ref{thm:retraction:Phi}.}
Consider a join of  $K$ with a one-point space, $\spc{J}=K\star \{s\}$.
As it stated above, $\spc{J}$ is a $\CAT(1)$ space.
By Reshetnyak's gluing theorem \cite[8.9.1]{akp} the space $\spc{W}$ glued from ${\spc{U}}$ and $\spc{J}$ along $K$ is a $\CAT(1)$ space;
moreover each space ${\spc{U}}$ and $\spc{J}$ is a convex subsets in $\spc{W}$.

\begin{wrapfigure}{o}{50 mm}
\vskip-0mm
\centering
\includegraphics{mppics/pic-2}
\end{wrapfigure} 

Let $\gamma$ be the geodesic in $\spc{W}$ from $p$ to the pole $s$ of $\spc{J}$.
Set $B_t=\bar B[\gamma(t),\tfrac\pi2]_{\spc{W}}$, then
\begin{itemize}
\item $B_0=\bar B[p,\tfrac\pi2]_{\spc{U}}\cup \spc{J}$,
\item $B_{\frac\pi2}=\spc{J}$, in particular $B_{\frac\pi2}\cap \spc{U}=K$,
\item the family $B_t$ is decreasing in $t$.
\end{itemize}
According to \ref{prop-def}, the family of $\tfrac\pi2$-tractrix maps $\phi_t$ provide a strong deformation retraction of $B_0$ to $B_{\frac\pi2}$ which is short and it is strictly short in case $\spc{U}$ is $\CAT(\kappa)$ for some $\kappa<\tfrac\pi2$.

Since ${\spc{U}}$ is $\CAT(1)$,
given a point $x\in B(p,\pi)$ there is unique geodesic $\gamma_x$ parametrized by its length from $p$ to $x$. 
By $\CAT(1)$ comparison, the map 
\[\Theta(x)=
\begin{cases}
p&\text{if\ }|p-x|_{\spc{U}}\ge \pi,
\\
\gamma_x(\pi-|p-x|_{\spc{U}})&\text{if\ }|p-x|_{\spc{U}}< \pi.
\end{cases}
\]
is a short retraction of ${\spc{U}}$ to $\bar B[p,\tfrac\pi2]_{\spc{U}}=B_0\cap \spc{U}$.
Moreover $\Theta$ is strictly short retraction if $\spc{U}$ is $\CAT(\kappa)$ for some $\kappa<\tfrac\pi2$.

Therefore the composition $\phi_{\frac\pi2}\circ\Theta$ induces a short retraction of ${\spc{U}}$ to $K$
which is strictly short in case $\spc{U}$ is $\CAT(\kappa)$ for some $\kappa<\tfrac\pi2$.

Finally, we need to take care of the case $\kappa<1$ and $p\notin K$.
Denote by $\bar p\in K$ the closest point to $p$; by $\CAT(\kappa)$ comparison it is uniquely defined.
Note that $|\bar p-x|_{\spc{U}}< |p-x|_{\spc{U}}$ for any $x\in K$;
therefore $K\subset B(\bar p,\tfrac\pi2)$. 
It remains to apply the construction above with $\bar p$ instead $p$.
\qeds


\parit{Proof of \ref{cor}.}
Consider the spherical join $\spc{U}\star\spc{U}$ and the map $\iota$ described at the beginning of the section. 
It is straightforward to see that 
\[|\iota(u_1,v_1,\tfrac\pi 4)-\iota(u_2,v_2,\tfrac\pi 4)|^2_{\spc{U}\star\spc{U}}\le |u_1-u_2|^2_{\spc{U}}+|v_1-v_2|_{\spc{U}}^2;\]
that is, the map $(u,v)\mapsto \iota(u,v,\tfrac\pi4)$ induces a short map 
\[\Theta\:{\tfrac1{\sqrt{2}}}\cdot(\spc{U}\times\spc{U})\to\spc{U}\star\spc{U}.\]
(The map $\Theta$ is also length preserving, but we will not need it.)

Note that the diagonal $\tfrac1{\sqrt{2}}\cdot\Delta$ is a convex set in $\tfrac1{\sqrt{2}}\cdot(\spc{U}\times\spc{U})$.
Moreover \ref{join-formula} implies that the restriction of $\Theta$ to $\tfrac1{\sqrt{2}}\cdot\Delta$ is distance preserving.
In particular the image $K=\Theta(\tfrac1{\sqrt{2}}\cdot\Delta)$ is a weakly convex set in $\spc{U}\star\spc{U}$.

Further note that $|p-x|_{\spc{U}\star\spc{U}}\le \tfrac\pi2$ for any $p\in K$.
Applying \ref{thm:retraction:Phi}, we get a short retraction $\Phi\:\spc{U}\star\spc{U}\to \Theta(\tfrac1{\sqrt{2}}\cdot\Delta)$.
Since $\Theta$ is short, it induces the needed short retraction $\Psi\:\spc{U}\times\spc{U}\to \Delta$.

Finally, by \ref{thm:retraction:Phi}, if $\kappa<1$, then $\Phi$ is a strictly short retraction and therefore so is $\Psi$.
\qeds



{\small\sloppy

\printbibliography[heading=bibintoc]

}

\end{document}
