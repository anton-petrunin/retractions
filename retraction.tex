\documentclass[oneside,a4paper, 12pt]{article}
\usepackage{anysize}
\usepackage{retraction}
\usepackage{biber}

\hypersetup{pdftitle={Short retractions of CAT(1) spaces},
pdfauthor={Alexander Lytchak and Anton Petrunin}}

\begin{document}
\title{Short retractions of CAT(1) spaces}
\author{Alexander Lytchak and Anton Petrunin}
\date{}
\maketitle

\begin{abstract}
We construct short retractions of a CAT(1) space to its small convex subsets.
This construction provides an alternative geometric description of an analytic tool introduced by Wilfrid Kendall.

Our construction use \emph{tractrix flow} which is defined as a gradient flow for a family of functions of certain type.
In the appendix we develop the necessary background in gradient flow which should be also useful elsewhere.
\end{abstract}


\section{Introduction}

\parbf{Results.}
Recall that a  subset $K$ in a metric space ${\spc{U}}$ is called \emph{weakly convex} if any two points $x,y\in K$ can be connected by a minimizing geodesic in $K$.

Let ${\spc{U}}$ be a metric space and $K\subset {\spc{U}}$.
A distance nonexpanding map $f\:{\spc{U}}\to K$ such that $f(x)=x$ for any $x\in K$ is called a \emph{short retraction to $K$}.
If in addition a local Lipschitz constant of $f$ is strictly less than 1 at any point $p\notin K$, 
then we say that $f$ is a \emph{strictly short retraction from ${\spc{U}}$ to $K$}.

\begin{thm}{Proposition}\label{thm:retraction:Phi}
Let $\spc{U}$ be a complete length $\CAT(\kappa)$ space.
Suppose $K$ is a weakly convex closed subset in $\spc{U}$ and $|p-x|\le \tfrac\pi2$ for for a fixed point $p\in \spc{U}$ and any point $x\in K$.


\begin{enumerate}[(a)]
 \item If $p\in K$ and $\kappa\le 1$, then there is a short retraction 
$\Phi\:\spc{U}\to K$.
\item If $\kappa<1$, then there is a strictly short retraction 
$\Phi\:\spc{U}\to K$.
\end{enumerate}
\end{thm}

This statement is a generalization of the following well known statement about $\CAT(0)$ spaces:
\emph{If ${\spc{U}}$ is a complete length $\CAT(0)$ space and $K$ is a closed convex subset in ${\spc{U}}$,
then the closest point projection ${\spc{U}}\to K$ is a short retraction.
Moreover, if $\spc{U}$ is a $\CAT(\kappa)$ space for some $\kappa<0$, then  the closest point projection is a strictly short retraction}.

\begin{thm}{Corollary}\label{cor}
Let $\spc{U}$ be a complete length $\CAT(\kappa)$ space.
Denote by $\Delta$ the diagonal in $\spc{U}\times \spc{U}$;
that is, $\Delta=\{\,(x,x)\in \spc{U}\times \spc{U}\,\}$.

Suppose there is a point $p\in \spc{U}$ such that $|p-x|\le \tfrac\pi2$ for any point $x\in \spc{U}$.
\begin{enumerate}[(a)]
\item
If $\kappa\le 1$, then there is a short retraction $\Psi\:\spc{U}\times \spc{U}\to \Delta$.
\item If $\kappa<1$, then there is a strictly short retraction $\Psi\:\spc{U}\times \spc{U}\to \Delta$.
\end{enumerate}

\end{thm}

It is well known that if $\spc{U}$ be a complete length $\CAT(0)$ space, then the midpoint map $\spc{U}\times \spc{U}\to \spc{U}$ is $\tfrac1{\sqrt{2}}$-Lipschitz and therefore it induces a short retraction $\spc{U}\times \spc{U}\to\Delta$. 
The corollary provides an analogous statement for $\CAT(1)$ spaces.


\parbf{Motivation.}
In \cite[(4.1)]{kendall}, Wilfrid Kendall observed that if $\spc{B}$ is a regular geodesic ball or radius $r<\tfrac\pi2$ in a manifold with sectional curvature at most 1, then for appropriate choice of constant $\lambda$, the following function
\[(x,y)\mapsto 
\frac{1+\lambda-\cos|x-y|_{\spc{B}}}{\cos|p-x|_{\spc{B}}\cdot \cos|p-y|_{\spc{B}}}
\]
has convex level sets in ${\spc{B}}\times {\spc{B}}$.
He also shows the existence of a nonnegative convex function on ${\spc{B}}\times {\spc{B}}$ that vanish only on the diagonal \cite[(4.2)]{kendall}.
These observations became a useful tool to study Dirichlet problem and its relatives;
it makes possible to extend number of results from Hadamard manifolds to Riemannian manifolds of small size
and more generally to $\CAT(1)$ spaces~\cite{yokota,BFHMSZ,fuglede,serbinowski}. 

Our original goal was to make this tool transparent for geometers.
Corollary~\ref{cor} can be considered as a more geometric version of this tool.
While Kendall's condition is optimal for uniqueness and regularity questions, the existence statements can be derived from  Proposition~\ref{thm:retraction:Phi} in a
slightly greater generality, as  we are going to explain now.

The following definition was introduced by Stefan Wenger \cite{Wenger-1comp};
for the definitions of ultrafilters and ultracompletions we refer to \cite{Wenger-1comp,guo-wenger,akp}.

A metric space ${\spc{U}}$ is called \emph{$1$-complemented} if for some \emph{non-principal ultrafilter} $\omega$  there exists a short retraction of ultracompletion ${\spc{U}}^{\omega}$ to~${\spc{U}}$.
The statement makes sense since any metric space ${\spc{U}}$ forms a subset in its ultracompletion ${\spc{U}}^{\omega}$, or more precisely, ${\spc{U}}$ admits a canonical isometric embedding into ${\spc{U}}^{\omega}$. 

Recall that if ${\spc{U}}$ is $\CAT(\kappa)$, then so is~${\spc{U}}^\omega$. 
Applying these observations together with Proposition~\ref{thm:retraction:Phi}, we obtain

\begin{thm}{Theorem}\label{thm:complemented}
Let ${\spc{U}}$ be a complete length $\CAT(1)$ space.
Assume  there exists some $p\in {\spc{U}}$ such that $|p-x|\le \tfrac\pi2$ for any point $x\in {\spc{U}}$.
Then ${\spc{U}}$ is $1$-complemented.
\end{thm}

Let us list few existence results which follow from the theorem, assuming that the space ${\spc{U}}$ as above:
\begin{enumerate}[(a)]
\item\label{dirichlet}   The existence of solution $u$ of Dirichlet problem on the minimization of energy 
in $W^{1,2} (\Omega, {\spc{U}})$ on any Lipschitz domain $\Omega$ in a Riemannian manifold with prescirbed trace $tr(u)$.
(See \cite{KS} and \cite[Theorem 1.4]{guo-wenger}).
\item The existence of a minimal integral $k$-current filling of any prescribed boundaryless $(k-1)$ integral current in ${\spc{U}}$. 
(See \cite{Ambrosio} and \cite[Theorem 3.3]{Wenger-1comp}.)
\item   The existence of a conformally parametrized disc $u:D\to {\spc{U}}$ of minimal area for a given boundary curve $\gamma$, which is a Jordan curve of finite length in ${\spc{U}}$.
(See \cite{LWplateau} and \cite[Theorem 1.2]{guo-wenger}).
\item\label{center} For any Radon measure $\mu$ on ${\spc{U}}$ there exists a center of mass $x\in {\spc{U}}$ for the measure~$\mu$ \cite{Sturm, yokota}.
\end{enumerate}

If in the theorem, we assume strict inequality $|p-x|< \tfrac\pi2$, then the existence results are known  in all the cases (\ref{dirichlet}--\ref{center}).
Moreover the uniqueness hold true under this stronger assumption
\cite{yokota,serbinowski}.
In our boundary case uniqueness definitely fails, since geodesics between points in a round hemisphere are not unique.

The uniqueness in each case can be shown using Corollary \ref{cor}.
Indeed if there are different solutions of one of these problems, then their product in ${\spc{U}}\times {\spc{U}}$ does not lie in the diagonal.
The latter contradicts the existence of the strictly short retraction $\Psi$ provided by Corollary \ref{cor}.

\parbf{About the proofs.}
We use a new tool which we call $r$-\emph{tractrix flow}; it gives a family of maps $\phi_t$ for a given rectifiable curve $t\mapsto\gamma(t)$.
The important properties of the tractrix flow are collected in Proposition~\ref{prop-def}.
In particular, (1) if $\spc{U}$ is $\CAT(1)$ and $r\le \tfrac\pi2$, then $\phi_t$ is short for any $t$, 
and (2) if $r< \tfrac\pi2$, then the local Lipschitz constant of $\phi_t$ at $p$ is strictly less than 1 if $p\ne \phi_t(p)$.

In the proof of Proposition~\ref{thm:retraction:Phi}, the tractrix flow is applied in a space arising by gluing $\spc{U}$ with a spherical cone over $K$ along $K$;
this space is $\CAT(1)$ by Reshetnyak's gluing theorem.

In the proof of Corollary~\ref{cor} the additional trick consists in identifying the product space $\spc{U}\z\times \spc{U}$ with a subset of the spherical join $\spc{U}\star \spc{U}$ and applying  Proposition~\ref{thm:retraction:Phi} to the latter.

The tricks in both proofs show that it is useful to consider singular spaces even in the case when the original space ($\spc{U}$) is perfectly smooth;
this is a powerful freedom of Alexandrov's world.
More involved examples of such arguments are given by Dmitry Burago, Sergei Ferleger, and Alexey Kanonenko \cite{BFK}, and Stephan Stadler~\cite{stadler}.

\section{Tractrix flow}\label{sec:Tractrix flow}

For $\CAT(\kappa)$ spaces, we will follow the conventions in \cite{akp}.

First let us describe the tractrix flow informally.
Suppose that two points $p$ and $q$ in ${\spc{U}}$ are connected to each other by a thread of fixed length $r$.
Imagine that the point $q$ follow the curve $\gamma$ and drags $p$ if the thread is tight; 
if the thread is not tight, then $p$ does not move.
Then the trajectory of the point $p$ will be called $r$-\emph{tractrix of $p$ with respect to~$\gamma$}.
The family of maps $\phi_t$ that send the initial position of $p$ to its position at the time $t$ will be called $r$-\emph{tractrix flow}.

Speaking more formally, let $\gamma\:[a,b]\to \spc{U}$ be a 1-Lipschitz curve. 
An $r$-tractrix with respect to $\gamma$ is defined as a gradient curve for the time-dependent family of functions 
\[f_t=- \max\{r,\dist_{\gamma(t)}\}\]
if the initial point lies in $\bar B[\gamma(a),r]$;
here $\bar B[x,r]$ denotes the closed ball of radius $r$ centered at $x$ and $\dist_{x}$ denotes the distance function from the point $x$.

The $r$-\emph{tractrix flow} with respect to $\gamma$ is defined as a family of maps
\[\phi_t\:\bar B[\gamma(a),r]\z\to\bar B[\gamma(t),r]\]
defined by $\phi_t\:p\mapsto \tau(t)$
for an $r$-tractrix $\tau\:[a,b]\to \spc{U}$ that starts at $p$; that is, $\tau(a)=p$.

The following proposition includes the properties of the tractrix flow which will be used further in the paper.

\begin{thm}{Proposition}\label{prop-def}
Let $\spc{U}$ be a complete length $\CAT(\kappa)$ space for $\kappa\le 1$ and $r<\pi$.
Then the $r$-tractrix flow $\phi_t\:\bar B[\gamma(a),r]\to\bar B[\gamma(t),r]$ is uniquely defined for any  1-Lipschitz curve $\gamma\:[a,b]\to \spc{U}$.

Moreover, if $r=\tfrac\pi2$, then
\begin{enumerate}[(a)]
 \item $\phi_t$ is short for any $t$;
 \item\label{strict} if $\kappa<1$, then there is a positive constant $\eps$ such that the local Lipschitz constant of $\phi_t$ at $p$ is bounded above by $\exp(-\eps\cdot\ell)$, where $\ell=|p-\phi_t(p)|_{\spc{U}}$.
 \item\label{sharafutdinov} If the family of balls $B_t=\bar B[\gamma(t),r]$ is decreasing in $t$ (that is, if $B_{t_1}\supset B_{t_2}$ for $t_1<t_2$), then $\phi_t$ is a strong deformation retraction from $B_a$ to $B_b$.
\end{enumerate}
\end{thm}

Historically the first relative of tractrix flow
is the so called \emph{Sharafutdinov's retraction} \cite{sharafutdinov} --- a family of maps associated to a continuous family of convex sets (in our case these sets are the balls $B_t$). 
Second relative is the \emph{pursuer flow} introduced and studied by Stephanie Alexander, Richard Bishop, Robert Ghrist and Chanyoung Jun \cite{ABG,jun-thesis,jun,jun:grad}.

Let us also mention that time-dependent gradient flows were studied by Chanyoung Jun \cite{jun-thesis,jun:grad} and  by Lucas C. F. Ferreira and Julio C. Valencia-Guevara \cite{ferreira-valencia}.
Gradient flows for time-independent function in $\CAT(\kappa)$ spaces were studied in \cite{lytchak-open-map} and \cite{ohta-palfia} and it is not hard to generalize their results to the time dependent flow.

These papers implicitly contain a proof of the proposition,
but we can not find a precise reference.
In the appendix we define time-dependent gradient flow and develop its properties which in imply Proposition~\ref{prop-def}, but should be useful elsewhere.
We also give the following sketch of a very direct proof;
a reader experienced with $\CAT(\kappa)$ comparison should be able to fill the details.

\parit{Stretch of proof.}
First let us define a \emph{discrete} tractrix.
Fix positive numbers $r<\pi$ and $\eps<\pi-r$. 
A sequence of points $q_0,\dots,q_n$ in  ${\spc{U}}$ will be called an $\eps$-chain if $|q_i-q_{i-1}|_{\spc{U}}<\eps$ for each $i$.
Suppose $p=p_0$ is a point that lies on distance at most $r$ from  $q_0$.
Consider a sequence $p_0,\dots,p_n$ defined recursively the following way:
\emph{$p_i$ is the closest point to $p_{i-1}$ on the geodesic $[p_{i-1}q_i]$ that lies on the distance at most $r$ from $q_i$}.
The sequence $p_0,\dots,p_n$ (if defined) will be called \emph{discrete tractrix} of $p$ with respect to the $\eps$-chain $q_0,\dots,q_n$.

Note that the triangle inequality implies that $(p_i)$ is an $\eps$-chain.
Since $|p_{i-1}-q_i|_{\spc{U}}<\pi$ for each $i$, the geodesic $[p_{i-1},q_i]$ is uniquely defined and 
so is the discrete tractrix $(p_i)$.

Now assume that $\gamma\:[a,b]\to \spc{U}$ is a Lipschitz curve.
Fix a fine partition $a=t_0<\dots<t_n=b$ and set $q_i=\gamma(t_i)$.
Since the partition is fine, we can assume that $(q_i)$ is an $\eps$-chain for any $\eps>0$ fixed in advance.
Moreover, we may assume that each arc $\gamma|_{[t_{i-1},t_i]}$ has diameter at most $\eps$ for each $i$.
Applying $\CAT(1)$ comparison it is straightforward to prove that for finer and finer partition the $p$-chain converges to a curve $\tau\:[a,b]\to \spc{U}$ which is an $r$-tractrix of $p$ with respect to $\gamma$.
The needed distance estimates follow from the corresponding estimates in the discrete case.
\qeds







\section{Proofs}\label{sec:proofs}

Recall that spherical join $\spc{U}\star\spc{V}$ of two metric spaces $\spc{U}$ and $\spc{V}$
is defined as the unit sphere equipped with the angle metric in the product of Euclidean cones $\Cone \spc{U}\times \Cone\spc{V}$. 
If diameters of $\spc{U}$ and $\spc{V}$ do not exceed $\pi$, then $\spc{U}\star\spc{V}$
can be defined as a metric space that admits an onto map $\iota\:\spc{U}\times\spc{V}\times[0,\tfrac\pi2]\to \spc{U}\star\spc{V}$ such that
\[
\begin{aligned}
|\iota(u_1,v_1,t_1)&-\iota(u_2,v_2,t_2)|_{\spc{U}\star\spc{V}}=
\\
&=\arccos[\sin t_1\cdot\sin t_2\cdot \cos|u_1-u_2|_{\spc{U}}+\cos t_1\cdot \cos t_2\cdot \cos|v_1-v_2|_{\spc{V}}].
\end{aligned}
\eqlbl{join-formula}
\]

Recall that join of two $\CAT(1)$ spaces is $\CAT(1)$ \cite[Corollary 3.14]{bridson-haefliger}.

\begin{wrapfigure}{o}{50 mm}
\vskip-0mm
\centering
\includegraphics{mppics/pic-2}
\end{wrapfigure} 

\parit{Proof of \ref{thm:retraction:Phi}.}
Consider a join of  $K$ with a one-point space, $\spc{J}=K\star \{s\}$.
Since $\spc{J}$ is a $\CAT(1)$ space,
by Reshetnyak's gluing theorem \cite[8.9.1]{akp}, the space $\spc{W}$ glued from ${\spc{U}}$ and $\spc{J}$ along $K$ is a $\CAT(1)$ space;
moreover each space ${\spc{U}}$ and $\spc{J}$ is a convex subsets in $\spc{W}$.


Let $\gamma$ be the geodesic in $\spc{W}$ from $p$ to the pole $s$ of $\spc{J}$.
Set $B_t=\bar B[\gamma(t),\tfrac\pi2]_{\spc{W}}$, then
\begin{itemize}
\item $B_0=\bar B[p,\tfrac\pi2]_{\spc{U}}\cup \spc{J}$,
\item $B_{\frac\pi2}=\spc{J}$, in particular $B_{\frac\pi2}\cap \spc{U}=K$,
\item the family $B_t$ is decreasing in $t$.
\end{itemize}
According to \ref{prop-def}(\ref{sharafutdinov}), the $\tfrac\pi2$-tractrix flow $\phi_t$ is a strong deformation retraction of $B_0$ to $B_{\frac\pi2}$.
Note that $\phi_{\frac\pi2}$ is a short retraction.
If $\kappa<1$, then by \ref{prop-def}(\ref{strict}), $\phi_{\frac\pi2}$ is a strictly short retraction.

Since ${\spc{U}}$ is $\CAT(1)$,
given a point $x\in B(p,\pi)$ there is unique geodesic $\gamma_x$ parametrized by its length from $p$ to $x$. 
By $\CAT(1)$ comparison, the map 
\[\Theta(x)=
\begin{cases}
p&\text{if\ }|p-x|_{\spc{U}}\ge \pi,
\\
\gamma_x(\pi-|p-x|_{\spc{U}})&\text{if\ }|p-x|_{\spc{U}}< \pi.
\end{cases}
\]
is a short retraction of ${\spc{U}}$ to $\bar B[p,\tfrac\pi2]_{\spc{U}}=B_0\cap \spc{U}$.
Moreover $\Theta$ is strictly short retraction if $\kappa<1$.

Therefore the composition $\Phi=\phi_{\frac\pi2}\circ\Theta$ induces a short retraction of ${\spc{U}}$ to $K$
which is strictly short if $\kappa<1$.

Finally, we need to take care of the case $\kappa<1$ and $p\notin K$.
Denote by $\bar p\in K$ the closest point to $p$; by $\CAT(\kappa)$ comparison it is uniquely defined.
Note that $|\bar p-x|_{\spc{U}}< |p-x|_{\spc{U}}$ for any $x\in K$;
therefore $K\subset B(\bar p,\tfrac\pi2)$. 
It remains to apply the construction above with $\bar p$ instead $p$.
\qeds


\parit{Proof of \ref{cor}.}
Consider the spherical join $\spc{U}\star\spc{U}$ and the map $\iota$ described at the beginning of the section. 
Note that \ref{join-formula} implies that the map $(u,v)\mapsto \iota(u,v,\tfrac\pi4)$
induces a length preserving map 
\[\Theta\:{\tfrac1{\sqrt{2}}}\cdot(\spc{U}\times\spc{U})\to\spc{U}\star\spc{U}.\]
In particular, $\Theta$ is short.

Note that the diagonal $\tfrac1{\sqrt{2}}\cdot\Delta$ is a convex set in $\tfrac1{\sqrt{2}}\cdot(\spc{U}\times\spc{U})$.
Moreover \ref{join-formula} implies that the restriction of $\Theta$ to $\tfrac1{\sqrt{2}}\cdot\Delta$ is distance preserving.
In particular the image $K=\Theta(\tfrac1{\sqrt{2}}\cdot\Delta)$ is a weakly convex set in $\spc{U}\star\spc{U}$.

Further note that $|p-x|_{\spc{U}\star\spc{U}}\le \tfrac\pi2$ for any $p\in K$.
Applying \ref{thm:retraction:Phi}, we get a short retraction $\Phi\:\spc{U}\star\spc{U}\to K$.
Since $\Theta$ is short, it induces the needed short retraction $\Psi\:\spc{U}\times\spc{U}\to \Delta$.

Finally, by \ref{thm:retraction:Phi}, if $\kappa<1$, then $\Phi$ is a strictly short retraction and therefore so is $\Psi$.
\qeds

\appendix
\section{Flow}

\parbf{Time-independent flow.}
Suppose $\spc{U}$ is a complete length $\CAT(\kappa)$ space.

For a locally Lipschitz semiconcave function $f$ defined on an open set $\Dom f\subset \spc{U}$, the differential $d_pf\:\T_p\to\RR$ is defined at each point $p\in \Dom f$;
it is a concave, Lipschitz, and positive-homogeneous of degree 1 function on the tangent space at $p$. %ADDREF

Further, for any point $p\in \Dom f$ there is unique tangent vector $u\in \T_p$
such that the following two conditions hold:
\[
\begin{aligned}
\langle u,w\rangle &\ge \nabla_{p}f(w),
\\
\langle u,u\rangle &= \nabla_{p}f(u).
\end{aligned}
\eqlbl{<u,w>}
\]
for any tangent vector $w\in \T_p$.%
\footnote{Here \emph{tangent vector} means \emph{element of tangent cone}, we use this term despite the tangent cone is not a vector space.
The scalar product $\langle u,w\rangle$ is defined as $|u|\cdot|w|\cdot\cos\theta$ where $\theta$ is the angle between the vectors.}
The vector $u$ is called \emph{gradient of $f$ at $p$}; briefly $u=\nabla_pf$.
%ADDREF

A locally Lipschitz map $t\mapsto \alpha(t)$ is called \emph{$f$-gradient curve} if it satisfies the following equation
\[\alpha^+(t)=\nabla_{\alpha(t)}f\eqlbl{grad-flow}\]
for any $t$, where $\alpha^+(t)\in \T_{\alpha(t)}$ denotes the \emph{right velocity vector}; that is,
\[\alpha^+(t)=\lim_{\eps\to 0+} \frac{\log_{\alpha(t)}[\alpha(t+\eps)]}\eps,\]
where $v=\log_pq$ if the vector $v\in\T_p$ points form $p$ in the direction of $q$ and $|v|=|p-q|$.

The following proposition can be extracted from \cite[Theorem 1.7]{lytchak-open-map}.

\begin{thm}{Proposition}\label{prop:time-independent}
Let ${\spc{U}}$ be a complete length $\CAT(\kappa)$ space and
$f$ a locally Lipschitz and semiconcave function defined on an open set $\Dom f\subset {\spc{U}}$.
Then for any
initial point $p\in \Dom f$  
there is unique $f$-gradient curve $t\mapsto\alpha(t)$ defined on a maximal semiopen interval $[0,\eps)$ for some $\eps>0$ such that $\alpha(0)=p$. 
\end{thm}

Note that the proposition can be applied recursively to obtain a gradient curve defined on a maximal semiopen interval.

\parbf{Time-dependent gradient flow.}
Our next aim is to define gradient flow for a time-dependent family of functions and prove an analog of Proposition~\ref{prop:time-independent} for this flow.
Let $f_t$ be family of functions defined on open subsets $\Dom f_t$ of~$\spc{U}$.
More precisely, we assume that the parameter $t$ lies in a real interval $\II$ and 
\[\Omega=\set{(x,t)\in\spc{U}\times \II}{x\in\Dom f_t}\]
is an open subset in $\spc{U}\times \II$.

The family $f_t$ is called continuous if for product of a closed set $K$ with a closed interval $[a,b]$ such that $K\times[a,b]\subset \Omega$ the family of the restrictions $f_t|_K$ is uniformly continuous in $[a,b]$.
A family of functions $f_t$ is called \emph{Lipschitz} if 
the function $x\mapsto f_t(x)$ is $L$-Lipschitz for some fixed $L$.
It is called \emph{locally Lipschitz} if each $(p_0,t_0)\in \Omega$ there is a neighborhood $\Omega'$ such that 
the restriction of the family to $\Omega'$ is Lipschitz.

A family of functions $f_t$ will be called \emph{$\lambda$-concave} if 
the function $x\mapsto f_t(x)$ is $\lambda$-concave for each $t$.
A family $f_t$ is called \emph{semiconcave} if for for each $(p_0,t_0)\in \Omega$ there is a neighborhood $\Omega'$ and $\lambda\in\RR$ such that the restriction of $f_t$ to $\Omega'$ is $\lambda$-concave. 

Note that one can not expect that a direct generalization of equation \ref{grad-flow} holds for a family of functions $f_t$.

For example, consider a $1$-Lipschitz curve $\alpha$ in the real line. 
Note that it is reasonable to assume that $\alpha$ is an $f_t$-gradient curve for the family $f_t(x)=-|x-\alpha(t)|$.
(Indeed $\alpha$ can be realized as a limit of the gradient curves for a smoothed family $f_t$.)
On the other hand, $\alpha^+(t)$ might be undefined,
but even it is defined, $\alpha^+(t)\ne0$ in general, while $\nabla_{\alpha(t)} f_t=0$.


Instead we define $f_t$-gradient curve as a curve $\alpha$ that satisfies the following inequality 
for $\eps>0$ and any point $p\in\spc{U}$ 
\[\dist_p\circ\alpha(t+\eps)\le \dist_p\circ\alpha(t)-\eps\cdot d_{\alpha(t)}f_t(\dir{\alpha(t)}p)+o(\eps),\eqlbl{def:tdflow}\]
where $\dir qp\in \T_{q}$ denotes a unit tangent vector at $q$ in the direction of $p$.

Note that if $\alpha^+(t)=\nabla_{\alpha(t)}f_t$, then \ref{def:tdflow} holds;
this follow from \ref{<u,w>}.
On the other hand, the example above shows that the converse does not hold;
that is, \ref{def:tdflow} generalize the definition~\ref{grad-flow}.

\begin{thm}{Distance estimate}
Let $f_t$ and $h_t$ be two families of $\lambda$-concave functions on a $\CAT(\kappa)$ space $\spc{U}$ and $s\ge 0$.
Assume $f_t$ and $h_t$ have common domain $\Omega\subset {\spc{U}}\times \RR$ and $|f_t(x)-h_t(x)|\le s$ for any $(x,t)\in \Omega$.
Assume $t\mapsto \alpha(t)$ and $t\mapsto \beta(t)$ are $f_t$- and $h_t$-gradient curves correspondingly, set $\ell(t)=|\alpha(t)-\beta(t)|_{\spc{U}}$.
If for some $t$ a minimizing geodesic $[\alpha(t),\beta(t)]$ lies in $\set{x\in {\spc{U}}}{(x,t)\in \Omega}$, then
\[\ell'(t)\le \lambda\cdot\ell(t)+s/\ell(t),\]
assuming that the left hand side is defined.

In particular the inequality holds for any $t\in\II$ if $\Omega\supset B(p,2\cdot r)\times \II$ and $\alpha(t),\beta(t)\z\in B(p, r)$ for any $t\in \II$.
\end{thm}

\parit{Proof.}
Choose a time moment $t$.
Let $p$ be the midpoint of the geodesic $[\alpha(t)\beta(t)]$.
Let $\gamma\:[0,\ell(t)]\to \spc{U}$ be an arc length parameterization of $[\alpha(t)\beta(t)]$ from $\alpha(t)$ to $\beta(t)$.
Note that $d_{\alpha(t)}f(\dir{\alpha(t)}{p})$ is the right derivative of $f\circ\gamma$ at $0$
and $-d_{\alpha(t)}g(\dir{\beta(t)}p)$ is the left derivative of $g\circ\gamma$ at $\ell(t)$.
Since $f$ and $g$ are $\lambda$-concave,
\begin{align*}
f(\beta(t))&\le f(\alpha(t)+\ell(t)\cdot d_{\alpha(t)}f(\dir{\alpha(t)}{p}) +\tfrac12\cdot\lambda\cdot\ell(t)^2,
\\
g(\alpha(t))&\le g(\beta(t)+\ell(t)\cdot d_{\alpha(t)}g(\dir{\beta(t)}p) +\tfrac12\cdot\lambda\cdot\ell(t)^2,
\end{align*}
Adding these inequalities up and taking into account that $|f(x)-g(x)|<s$ for any $x$, we conclude that 
\[d_{\alpha(t)}f(\dir{\alpha(t)}{p})+d_{\alpha(t)}g(\dir{\beta(t)}p)\ge \lambda\cdot \ell(t)+2\cdot s/\ell(t).\]

Applying the triangle inequality and the definition of gradient curve at $p$, we get that
\begin{align*}
\ell(t+\eps)&=|\alpha(t+\eps)-\beta(t+\eps)|\le
\\
&\le |\alpha(t+\eps)-p|+|\beta(t+\eps)-p|\le 
\\
&\le |\alpha(t)-p|-\eps\cdot d_{\alpha_t}f(\dir{\alpha(t)}{p})+|\beta(t+\eps)-p|-\eps\cdot d_{\beta_t}g(\dir{\beta(t)}p)+o(\eps)=
\\
&=\ell(t)-\eps\cdot(\lambda\cdot \ell(t)+2\cdot s/\ell(t))+o(\eps)
\end{align*}
for $\eps>0$; whence the statement.
\qeds

\begin{thm}{Proposition}\label{prop:def-time-dependent}
Let $\spc{U}$ be a complete length $\CAT(\kappa)$ space.
Suppose $f_t$ is a family of $\lambda$-concave functions for $t\in [a,b)$ and $\Dom f_t\supset B(z,2\cdot r)$ for some fixed $z\in\spc{U}$, $r>0$ and any~$t$.

Let $\alpha\:[a,b)\to B(z,r)$ be a Lipschitz curve.
Then $\alpha$ is a $f_t$-gradient if and only if 
\[\dist_p\circ\alpha(t+\eps)\le \dist_p\circ\alpha(t)-\eps\cdot \left[\tfrac{f(p)-f\circ\alpha(t)}{|p-\alpha(t)|}-\tfrac\lambda2\cdot |p-\alpha(t)|\right]+o(\eps)\eqlbl{def:tdflow-plus}\]
for any $p\in B(z,r)$.
\end{thm}

\parit{Proof.}
Note that geodesics $[\alpha(t)p]$ lie in $\Dom f_t$ for any $t$.

Since $f_t$ is $\lambda$ concave, we have that 
\[d_{\alpha(t)}f_t(\dir{\alpha(t)}p)\ge \tfrac{f(p)-f\circ\alpha(t)}{|p-\alpha(t)|}-\tfrac\lambda2\cdot |p-\alpha(t)|.\]
Whence the only-if part follows.

Given a point $p\in \spc{U}$ and $t$,
consider a point $\bar p\in [\alpha(t)p]$.
Applying \ref{def:tdflow-plus} for $\bar p$ and the triangle inequality, we get
\[\dist_p\circ\alpha(t+\eps)\le \dist_p\circ\alpha(t)-\eps\cdot \left[\tfrac{f(\bar p)-f\circ\alpha(t)}{|\bar p-\alpha(t)|}-\tfrac\lambda2\cdot |\bar p-\alpha(t)|\right]+o(\eps).\]
By taking $\bar p$ close to $\alpha(t)$,
the value $\tfrac{f(\bar p)-f\circ\alpha(t)}{|\bar p-\alpha(t)|}-\tfrac\lambda2\cdot |\bar p-\alpha(t)|$ can be made arbitrary close to $d_{\alpha(t)}f_t(\dir{\alpha(t)}p)$.
Therefore, given $\delta>0$, the following inequality
\[\dist_p\circ\alpha(t+\eps)\le \dist_p\circ\alpha(t)-\eps\cdot d_{\alpha(t)}f_t(\dir{\alpha(t)}p)+\eps\cdot\delta\]
holds for all sufficiently small positive values $\eps$.
Therefore \ref{def:tdflow} holds.
\qeds


Now we are ready to formulate and prove an analog of Proposition~\ref{prop:time-independent} for time-dependent family.

\begin{thm}{Proposition}\label{prop:time-dependent}
Let $\spc{U}$ be a complete length $\CAT(\kappa)$ space and
$\{f_t\}_{t\in[a,b)}$ a continuous locally Lipschitz and semiconcave family of function defined on an open sets $\Dom f_t\subset {\spc{U}}$.
Then for any initial point $p\in \Dom f_a$ and sufficiently small $\eps=\eps(p)>0$ there is a unique $f$-gradient curve $t\mapsto\alpha(t)$ defined on a semiopen interval $[a,a+\eps)$. 
\end{thm}

As well as its time-independent version, this proposition can be applied recursively to obtain a unique gradient curve defined on a maximal semiopen interval.

\parit{Proof.}
By \ref{prop:time-independent}, the proposition holds if $f_t$ is a constant family.
Moreover it holds if $f_t$ is piecewise constant;
that is, if there is a partition of interval $[a,b)$ into a finite collection of semiopen subintervals such that $f_t$ is time-independent on each of subintervals and its domain is fixed.

Fix $\eps>0$ sufficiently small so that there is $L$ such that the functions $f_t$ are $L$-Lipschitz and $\Dom f_t\supset B(p,\eps\cdot L)$ for any $t\in[a,a+\eps)$.
Consider sequence  $a=t_0<t_1\dots<t_n\z=a+\eps$ and a piecewise constant family of functions on $B(p,\eps\cdot L)$ defined by $\hat f_t=f_{t_i}$ if $t_i\le t<t_{i+1}$.
By above discussion we have that there is a unique $\hat f_t$-gradient curve $\hat \alpha$ that starts at $p$ and defined on the interval $[a,a+\eps)$.

Note that the distance estimates show that as the partition gets finer, the gradinet curves $\hat\alpha$ form a Cauchy sequence; denote its limit by $\alpha$.

Note that 
\begin{align*}
\dist_p\circ\hat\alpha(t+\eps)
&\le 
\dist_p\circ\hat\alpha(t)
-\eps\cdot \left[\tfrac{\hat f_t(p)-\hat f_t\circ\hat\alpha(t)}{|p-\alpha(t)|}-\tfrac\lambda2\cdot |p-\hat\alpha(t)|\right]
+o(\eps)
\\
&\le 
\dist_p\circ\hat\alpha(t)
-\eps\cdot \left[\tfrac{f_t(p)-f_t\circ\hat\alpha(t)-2\cdot s}{|p-\alpha(t)|}-\tfrac\lambda2\cdot |p-\hat\alpha(t)|\right]
+o(\eps)
\end{align*}
where 
\[s=\sup_{t,x} \{|f_t(x)-\hat f_t(x)|\}.\]
Since $s\to 0$ as $\hat\alpha\to \alpha$, we get that \ref{def:tdflow-plus} holds for $\alpha$;
that is, $\alpha$ is an $f_t$-gradient curve.
\qeds



{\small\sloppy

\printbibliography[heading=bibintoc]

}

\end{document}
